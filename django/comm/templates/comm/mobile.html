<!doctype html>
<html>
<head>
<title>Mobile Site--Communication tool</title>
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.2/css/bootstrap-theme.min.css">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.2/css/bootstrap.min.css">
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

  <!-- socketIO -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.4/socket.io.min.js"></script>

  <!-- bootstrap dependencies -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.2/js/bootstrap.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style type="text/css">

    div#header{
      position: fixed; 
      top: 0px; 
      height: 60px; 
      width: 100%; 
      background-color: #337ab7; 
      z-index: 1000000;
    }
    .header_text{
      font-size: 20px;
      text-align: center;
      color: white;

    }
 /*颜色出不来 需要调整*/
   div#message_search {
      top: 70px;
      bottom: 15px;
    }
    .padded-icon {
      padding-right: 10px;
      font-size: 20px;
    }
    div#roomlist{

    }
    .sidebar_description {
      text-align: center;
      padding-bottom: 5px;
      padding-top:5px;
      background-color: #5bc0de;
      color: white;
    }
    .user_list {
      padding-left: 15px;
    }
    div#footer {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 60px;/*脚部的高度*/
    background: #337ab7;
    clear:both;
  }
    .footer-content{
      color: white;
      margin-top: 10px;
    }
    .padded-icon {
      padding-right: 10px;
      font-size: 20px;
  }

</style>
</head>
<body>
<div id="wrapper">

<!--header-->
<div id="header" class="col-xs-12">
    <h1 class="header_text"> Comm-Tool </h1> 
</div>  
<!--search bar-->
<div id="message_search" class="col-xs-10 col-xs-offset-1">
  <div class="input-group">
  <input type="text" class="form-control" placeholder="Search messages...">
       <span class="input-group-btn">
           <button class="btn btn-default" type="button">
            <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
           </button>
       </span>
   </input>
 </div>
<!--room list-->
<div  id="list">
   <div class="list-group" id="room-list" >
    <h4 class="sidebar_description">Chatting Room</h4>
 <a href="#" class="list-group-item " data-toggle="button" onclick="general()">
  <span class="glyphicon glyphicon-globe padded-icon" aria-hidden="true"></span>
  General
 </a>
 <a href="#" class="list-group-item " data-toggle="button" onclick="teamone()">
  <span class="glyphicon glyphicon-comment padded-icon" aria-hidden="true" ></span>
  Team One
  <span class="badge">4</span>
 </a>
 <a href="#" class="list-group-item " data-toggle="botton" onclick="teamtwo()">
  <span class="glyphicon glyphicon-comment padded-icon" aria-hidden="true" ></span>
  Team Two
 </a>
 <a href="#" class="list-group-item" data-toggle="botton" onclick="teamthree()">
  <span class="glyphicon glyphicon-comment padded-icon" aria-hidden="true" ></span>
  Team three
 </a>
 <a href="#" class="list-group-item">
  <span class="glyphicon glyphicon-plus padded-icon" aria-hidden="true"></span>
  Create New Teams
 </a>
   </div>

<!--user list-->
  <div class="list-group" id="group-list">
<h4 class="sidebar_description">Recent contacts</h4>

<ul class="user_list">
   <li class="user"><a href="#">
    <span class="glyphicon glyphicon-user padded-icon"></span>Oscar</a>
   </li>
   <li class="user"><a href="#">
    <span class="glyphicon glyphicon-user padded-icon"></span>Bill</a>
   </li>
   <li class="user disabled"><a href="#">
    <span class="glyphicon glyphicon-user padded-icon"></span>Sherry</a>
   </li>
   <li class="user disabled"><a href="#">
    <span class="glyphicon glyphicon-user padded-icon"></span>Jenna</a>
   </li>
   <li class="user disabled"><a href="#">
    <span class="glyphicon glyphicon-user padded-icon"></span>Jewel</a>
   </li>
</ul>
  </div>
</div>

<!--text bar-->
<!--general chatting bar-->
<div class="hidden" id="general">
  <div id="room-header">
 <div class="list-group">
 <h4 class="sidebar_description">General</h4>
 
</div>
<div class="widget-content nopadding">
               <div class="chat-content panel-left">                   
                   <div class="chat-messages" id="chat-messages">
                   </div> 
                  </div> 

</div>
</div>
<div class="input-group input-group-lg">
  <input id="textbar" type="text" class="form-control" placeholder="Enter a message..."> 
   
     <span class="input-group-btn">
         <button id="sendcleartext" class="btn btn-default" type="button" onclick="display()" >
          <span class="glyphicon glyphicon-expand" aria-hidden="true"></span>
         </button>
    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
        <span class="glyphicon glyphicon-plus-sign"></span>
      </button>
      <ul class="dropdown-menu" role="menu">
        <li><a href="#">upload file</a></li>
        <li><a href="#">emoticons</a></li>
      </ul>
     </span>
  </div>
</div>

<!--teamone chatting bar-->
<div class="hidden" id="teamone">
  <div id="room-header">
 <div class="list-group">
 <h4 class="sidebar_description">Team one</h4>
 
</div>
<div class="widget-content nopadding">
               <div class="chat-content panel-left">                   
                   <div class="chat-messages" id="chat-messages">
                    
                   </div> 
                  </div> 

</div>
</div>
<div class="input-group input-group-lg">
  <input id="textbar" type="text" class="form-control" placeholder="Enter a message..."> 
   
     <span class="input-group-btn">
         <button id="sendcleartext" class="btn btn-default" type="button" onclick="display()" >
          <span class="glyphicon glyphicon-expand" aria-hidden="true"></span>
         </button>
    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
        <span class="glyphicon glyphicon-plus-sign"></span>
      </button>
      <ul class="dropdown-menu" role="menu">
        <li><a href="#">upload file</a></li>
        <li><a href="#">emoticons</a></li>
      </ul>
     </span>
  </div>
</div>
<!--teamtwo chatting bar-->
<div class="hidden" id="teamtwo">
  <div id="room-header">
 <div class="list-group">
 <h4 class="sidebar_description">Team two</h4>
 
</div>
<div class="widget-content nopadding">
               <div class="chat-content panel-left">                   
                   <div class="chat-messages" id="chat-messages">
                    
                   </div> 
                  </div> 

</div>
</div>
<div class="input-group input-group-lg">
  <input id="textbar" type="text" class="form-control" placeholder="Enter a message..."> 
   
     <span class="input-group-btn">
         <button id="sendcleartext" class="btn btn-default" type="button" onclick="display()" >
          <span class="glyphicon glyphicon-expand" aria-hidden="true"></span>
         </button>
    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
        <span class="glyphicon glyphicon-plus-sign"></span>
      </button>
      <ul class="dropdown-menu" role="menu">
        <li><a href="#">upload file</a></li>
        <li><a href="#">emoticons</a></li>
      </ul>
     </span>
  </div>
</div>
<!--teamthree chatting bar-->
<div class="hidden" id="teamthree">
  <div id="room-header">
 <div class="list-group">
 <h4 class="sidebar_description">Team three</h4>
 
</div>
<div class="widget-content nopadding">
               <div class="chat-content panel-left">                   
                   <div class="chat-messages" id="chat-messages">
                   
                   </div> 
                  </div> 

</div>
</div>
<div class="input-group input-group-lg">
  <input id="textbar" type="text" class="form-control" placeholder="Enter a message..."> 
   
     <span class="input-group-btn">
         <button id="sendcleartext" class="btn btn-default" type="button" onclick="display()" >
          <span class="glyphicon glyphicon-expand" aria-hidden="true"></span>
         </button>
    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
        <span class="glyphicon glyphicon-plus-sign"></span>
      </button>
      <ul class="dropdown-menu" role="menu">
        <li><a href="#">upload file</a></li>
        <li><a href="#">emoticons</a></li>
      </ul>
     </span>
  </div>
</div>

</div>
</div>

<!--footer-->
 <div id="footer">

      <div class="col-xs-4 footer-content">
         <span class="glyphicon glyphicon-comment padded-icon" aria-hidden="true"></span>
         <p>
          Room List 
         </p>
      </div>
       <div class="col-xs-4 footer-content">
         <span class="glyphicon glyphicon-user padded-icon"></span>
         <p>User List
         </p>
      </div> 
      <div class="col-xs-4 footer-content">
         <span class="glyphicon glyphicon-check padded-icon"></span>
         <p>Quick Link
         </p>
      </div>

</div>
</div>
<script>
//go to different room
function general(){
$('div#list').addClass('hidden');
$('div#general').removeClass('hidden');
};
function teamone(){
$('div#list').addClass('hidden');
$('div#teamone').removeClass('hidden');
};
function teamtwo(){
$('div#list').addClass('hidden');
$('div#teamtwo').removeClass('hidden');
};
function teamthree(){
$('div#list').addClass('hidden');
$('div#teamthree').removeClass('hidden');
};

var server_host = window.location.hostname;
var socket = io('http://' + server_host + ':3000');
var username = random_user();

// Get the messages from the API and add to the page
  $.getJSON('http://' + server_host + ':8000/api/messages/?format=json', function(json) {
    json.results.forEach(function(msg){
      add_message(msg.text);
    });
  });

// When you receive a message, add it to the page
  socket.on('msg', function(msg){
    add_message(msg);
  });

  function add_message(msg) {
    $('div#chat-messages').append(msg + '<br>');
  };
  
// Called when button is clicked
  function display() {
    var message = username + " : " + document.getElementById("textbar").value;
    socket.emit('msg', message);
    $('input#textbar').val('');
  }
  
// Generate random user
  function random_user() {
    var random_index = Math.floor( Math.random() * 100 ) + 1;
    return "User " + random_index;
  }

// Add a new message whenever the user presses the enter key
  $(document).keypress(function(e) {
      if(e.which == 13) {
          display();
      }
  });


</script>
</body>
